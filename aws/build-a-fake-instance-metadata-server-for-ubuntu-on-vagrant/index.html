
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A site for knowledge sharing and neat things.">
      
      
        <link rel="canonical" href="http://copperlight.github.io/aws/build-a-fake-instance-metadata-server-for-ubuntu-on-vagrant/">
      
      
        <meta name="author" content="Matthew Johnson">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.1">
    
    
      
        <title>Build a Fake Instance Metadata Server for Ubuntu on Vagrant - Copperlight Writes</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-a20f419c8e.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Menlo">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Menlo","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://copperlight.github.io/" title="Copperlight Writes" class="md-header-nav__button md-logo">
          
            <i class="md-icon md-icon--home"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  AWS
                </span>
              
            
            Build a Fake Instance Metadata Server for Ubuntu on Vagrant
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/copperlight/copperlight.github.io" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </div>
    Copperlight Writes
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/copperlight/copperlight.github.io" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Ansible
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Ansible
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ansible/ansible-vault-and-ssh-key-distribution/" title="Ansible Vault and SSH Key Distribution" class="md-nav__link">
      Ansible Vault and SSH Key Distribution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ansible/running-ansible-playbooks-on-windows/" title="Running Ansible Playbooks on Windows" class="md-nav__link">
      Running Ansible Playbooks on Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ansible/testing-ansible-galaxy-roles-with-docker/" title="Testing Ansible Galaxy Roles with Docker" class="md-nav__link">
      Testing Ansible Galaxy Roles with Docker
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      AWS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        AWS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../assume-role-with-awscli/" title="Assume Role with AWSCLI" class="md-nav__link">
      Assume Role with AWSCLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aws-credential-files-for-java-and-python/" title="AWS Credential Files for Java and Python" class="md-nav__link">
      AWS Credential Files for Java and Python
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="Build a Fake Instance Metadata Server for Ubuntu on Vagrant" class="md-nav__link md-nav__link--active">
      Build a Fake Instance Metadata Server for Ubuntu on Vagrant
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../checking-and-changing-content-type-of-s3-object-with-awscli/" title="Checking and Changing Content-Type of S3 Object with AWSCLI" class="md-nav__link">
      Checking and Changing Content-Type of S3 Object with AWSCLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configuring-multiple-interfaces-on-the-same-network-in-ec2/" title="Configuring Multiple Interfaces on the Same Network in EC2" class="md-nav__link">
      Configuring Multiple Interfaces on the Same Network in EC2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      GitHub
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        GitHub
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../github/how-i-built-my-site/" title="How I Built My Site" class="md-nav__link">
      How I Built My Site
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/linux-ftrace-delivers-dtrace-like-functionality/" title="Linux ftrace Delivers dtrace-like Functionality" class="md-nav__link">
      Linux ftrace Delivers dtrace-like Functionality
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/clone-stash-pull-requests/" title="Clone Stash Pull Requests" class="md-nav__link">
      Clone Stash Pull Requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/dual-boot-osx-10.10-and-ubuntu-14.04-on-a-2013-macbook-pro-retina/" title="Dual Boot OSX 10.10 and Ubuntu 14.04 on a 2013 Macbook Pro Retina" class="md-nav__link">
      Dual Boot OSX 10.10 and Ubuntu 14.04 on a 2013 Macbook Pro Retina
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/reset-jenkins-build-number/" title="Reset Jenkins Build Number" class="md-nav__link">
      Reset Jenkins Build Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/switching-jdks-in-osx/" title="Switching JDKs in OSX" class="md-nav__link">
      Switching JDKs in OSX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/accessing-google-apis-with-python/" title="Accessing Google APIs with Python" class="md-nav__link">
      Accessing Google APIs with Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/building-rest-apis-with-python-flask/" title="Building REST APIs with Python Flask" class="md-nav__link">
      Building REST APIs with Python Flask
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/install-the-latest-python-versions-on-macosx/" title="Install the Latest Python Versions on Mac OSX" class="md-nav__link">
      Install the Latest Python Versions on Mac OSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/memory-profiling-with-pyrasite-and-heapy/" title="Memory Profiling with Pyrasite and Heapy" class="md-nav__link">
      Memory Profiling with Pyrasite and Heapy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/stop-using-print-for-debugging/" title="Stop Using "print" for Debugging" class="md-nav__link">
      Stop Using "print" for Debugging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Scala
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Scala
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/intellij-configuration-tips/" title="IntelliJ Configuration Tips" class="md-nav__link">
      IntelliJ Configuration Tips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/overview-of-debugging-tools/" title="Overview of Debugging Tools" class="md-nav__link">
      Overview of Debugging Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/scalafmt-configuration-tips/" title="Scalafmt Configuration Tips" class="md-nav__link">
      Scalafmt Configuration Tips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/starting-scala-repls-with-gradle-and-sbt/" title="Starting Scala REPLs with Gradle and SBT" class="md-nav__link">
      Starting Scala REPLs with Gradle and SBT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/testing-aws-clients-with-iam-assumerole-credentials-in-scala/" title="Testing AWS Clients with IAM AssumeRole Credentials in Scala" class="md-nav__link">
      Testing AWS Clients with IAM AssumeRole Credentials in Scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/using-gradle-to-run-scala-projects-locally/" title="Using Gradle to Run Scala Projects Locally" class="md-nav__link">
      Using Gradle to Run Scala Projects Locally
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scala/using-the-scala-repl-to-configure-amazon-ses-notifications/" title="Using the Scala REPL to Configure Amazon SES Notifications" class="md-nav__link">
      Using the Scala REPL to Configure Amazon SES Notifications
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Shell
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Shell
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/measuring-transfer-speed-over-time-with-curl/" title="Measuring Transfer Speed Over Time with cURL" class="md-nav__link">
      Measuring Transfer Speed Over Time with cURL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/parsing-json-on-the-command-line/" title="Parsing JSON on the Command Line" class="md-nav__link">
      Parsing JSON on the Command Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/pet-cli-snippet-manager/" title="pet - CLI Snippet Manager" class="md-nav__link">
      pet - CLI Snippet Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/schedule-ad-hoc-jobs-for-later-on-an-instance-with-atd/" title="Schedule Ad-Hoc Jobs for Later on an Instance with atd" class="md-nav__link">
      Schedule Ad-Hoc Jobs for Later on an Instance with atd
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Talks
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Talks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../talks/netflix-atlas-telemetry-a-platform-begets-an-ecosystem/" title="Netflix Atlas Telemetry - A Platform Begets an Ecosystem" class="md-nav__link">
      Netflix Atlas Telemetry - A Platform Begets an Ecosystem
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="build-a-fake-instance-metadata-server-for-ubuntu-on-vagrant">Build a Fake Instance Metadata Server for Ubuntu on Vagrant<a class="headerlink" href="#build-a-fake-instance-metadata-server-for-ubuntu-on-vagrant" title="Permanent link">&para;</a></h1>
<div class="meta">
  <span class="date"><small>2014-07-22</small></span>
  <span class="discuss"><a class="github-button" href="https://github.com/copperlight/copperlight.github.io/issues" data-icon="octicon-issue-opened" aria-label="Discuss copperlight/copperlight.github.io on GitHub">Discuss</a></span>
</div>

<p><br/></p>
<p>Let's say that you have a proper build/bake/deploy pipeline in place for running appications in AWS.
This is a reliable way to deploy applications at scale and move traffic between different versions
of applications as a part of the deployment pipeline.  However, the whole process may take 20-40
minutes or so to complete for any particular build.  If you want to iterate more rapidly on your
development efforts, you could skip the full process with a quickpatch ssh/rsync deployment to a
single server or you could stand up a local Vagrant base image and iterate on that.  Now let's say
that the application you are working on is intended to work with instance metadata, particularly for
the purpose of obtaining a rotating set of access and secret keys.  It might be nice to have a fake
metadata service running on your local Vagrant image so that you can test your application in a
manner similar to how it will be running in the cloud.  In this post, I describe how to build and
configure a fake metadata service for an Ubuntu image running on Vagrant.</p>
<h1 id="package-layout">Package Layout<a class="headerlink" href="#package-layout" title="Permanent link">&para;</a></h1>
<p>This layout assumes that you will be installing custom packages to the <code>/apps</code> directory, and there
is a <a href="http://cr.yp.to/daemontools.html">daemontools</a> service hierarchy located at <code>/service</code>.  The
<code>fake-metadata/service/run</code> file is a script suitable for use with daemontools.</p>
<div class="codehilite"><pre><span></span>root/
├── apps
│   └── fake-metadata
│       ├── app.py
│       └── service
│           └── run
└── etc
    ├── init.d
    │   └── fake-metadata
    ├── logrotate.d
    │   └── fake-metadata
    └── network
        └── iptables.rules
</pre></div>


<h1 id="building-and-packaging">Building and Packaging<a class="headerlink" href="#building-and-packaging" title="Permanent link">&para;</a></h1>
<p>For cross-platform build packaging, it will be easiest to use the
<a href="https://github.com/nebula-plugins/gradle-ospackage-plugin">nebula ospackage</a> plugin with Gradle.
With this plugin available, your build script will look something like this:</p>
<div class="codehilite"><pre><span></span><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;nebula-ospackage&#39;</span>

<span class="n">ospackage</span> <span class="o">{</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span>
    <span class="n">packageName</span><span class="o">=</span><span class="s1">&#39;fake-metadata&#39;</span>

    <span class="n">requires</span><span class="o">(</span><span class="s1">&#39;python-flask&#39;</span><span class="o">)</span>

    <span class="n">link</span><span class="o">(</span><span class="s1">&#39;/apps/fake-metadata/logs&#39;</span><span class="o">,</span> <span class="s1">&#39;/mnt/logs/fake-metadata&#39;</span><span class="o">)</span>
    <span class="n">link</span><span class="o">(</span><span class="s1">&#39;/service/fake-metadata&#39;</span><span class="o">,</span> <span class="s1">&#39;/apps/fake-metadata/service&#39;</span><span class="o">)</span>
<span class="o">}</span>

<span class="n">buildDeb</span> <span class="o">{</span>
    <span class="n">postInstall</span> <span class="nf">file</span><span class="o">(</span><span class="s1">&#39;scripts/postInstall.sh&#39;</span><span class="o">)</span>
    <span class="n">preUninstall</span> <span class="s1">&#39;svc -d /service/fake-metadata&#39;</span>
    <span class="n">postUninstall</span> <span class="nf">file</span><span class="o">(</span><span class="s1">&#39;scripts/postUninstall.sh&#39;</span><span class="o">)</span>
<span class="o">}</span>

<span class="n">task</span> <span class="nf">build</span><span class="o">(</span><span class="nl">dependsOn:</span> <span class="o">[</span><span class="s1">&#39;buildDeb&#39;</span><span class="o">])</span>
</pre></div>


<h1 id="fake-metadata-application">Fake Metadata Application<a class="headerlink" href="#fake-metadata-application" title="Permanent link">&para;</a></h1>
<p>The simplest approach to building the service is to create a <a href="http://flask.pocoo.org/">Flask</a>
service and have it run bare on the Vagrant instance.  Given how small it will be and limited amount
of traffic it will need to serve, there is no need to run this behind a dedicated static webserver
like nginx or Apache.  The nice thing about using Flask and having a basic structure in place is
that it is then easy to extend the application to add other endpoints when needed.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">abort</span><span class="p">,</span> <span class="n">make_response</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="n">BaseIAMRole</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;Code&#39;</span><span class="p">:</span> <span class="s1">&#39;Success&#39;</span><span class="p">,</span>
  <span class="s1">&#39;LastUpdated&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="s1">&#39;AWS-HMAC&#39;</span><span class="p">,</span>
  <span class="s1">&#39;AccessKeyId&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;SecretAccessKey&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Token&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Expiration&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;latest&#39;</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">latest</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;meta-data&#39;</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/meta-data/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">meta_data</span><span class="p">():</span>
    <span class="n">endpoints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;iam&#39;</span><span class="p">,</span>
        <span class="s1">&#39;public-hostname&#39;</span><span class="p">,</span>
        <span class="s1">&#39;public-ipv4&#39;</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">endpoints</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/meta-data/iam/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">iam</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;security-credentials&#39;</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/meta-data/iam/security-credentials/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">security_credentials</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;BaseIAMRole&#39;</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/meta-data/iam/security-credentials/BaseIAMRole&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">base_iam_role</span><span class="p">():</span>
    <span class="c1"># update the payload to contain a current set of accesss and secrey keys</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">BaseIAMRole</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/meta-data/public-hostname&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">public_hostname</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;EC2_LOCAL_HOSTNAME&#39;</span><span class="p">]</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/latest/meta-data/public-ipv4&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">public_ipv4</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;EC2_LOCAL_IPV4&#39;</span><span class="p">]</span>


<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">(</span> <span class="p">{</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;bad request&#39;</span> <span class="p">}</span> <span class="p">),</span> <span class="mi">400</span><span class="p">)</span>


<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">(</span> <span class="p">{</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;not found&#39;</span> <span class="p">}</span> <span class="p">),</span> <span class="mi">404</span><span class="p">)</span>


<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">(</span> <span class="p">{</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;internal server error&#39;</span> <span class="p">}</span> <span class="p">),</span> <span class="mi">500</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">host</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">port</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h1 id="daemontools-run-script">Daemontools Run Script<a class="headerlink" href="#daemontools-run-script" title="Permanent link">&para;</a></h1>
<p>This script is watched by the supervise process, which then starts (or restarts) the application if
it is not running.  Switching to a non-root user and redirecting output to the log file occurs here.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">ulimit</span> -n <span class="m">32768</span>

<span class="nb">source</span> /etc/profile.d/environment.sh

<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/command:/usr/local/bin:/usr/local/sbin:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/scripts

<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;/mnt/logs/fake-metadata&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  mkdir -p /mnt/logs/fake-metadata
  chmod <span class="m">0777</span> /mnt/logs/fake-metadata
<span class="k">fi</span>

<span class="nv">USER</span><span class="o">=</span>someuser
<span class="nv">PYTHON</span><span class="o">=</span>/usr/bin/python
<span class="nv">APP</span><span class="o">=</span>/apps/fake-metadata/app.py
<span class="nv">OPTS</span><span class="o">=</span><span class="m">127</span>.0.0.1:8000
<span class="nv">LOG</span><span class="o">=</span>/mnt/logs/fake-metadata/server.log

<span class="nb">echo</span> <span class="s2">&quot;starting fake-metadata&quot;</span>
<span class="nb">exec</span> setuidgid <span class="nv">$USER</span> <span class="nv">$PYTHON</span> <span class="nv">$APP</span> <span class="nv">$OPTS</span> &gt;&gt; <span class="nv">$LOG</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</td></tr></table>

<h1 id="postinstall-script">PostInstall Script<a class="headerlink" href="#postinstall-script" title="Permanent link">&para;</a></h1>
<p>This is where most of the trickiness occurs.</p>
<p>The post install script is responsible for modifying the <code>/etc/network/interfaces</code> file, adding the
metadata server IP address and configuring iptables in an idempotent manner.  When the post install
script is packaged by the nebula ospackage plugin into a Debian package, it gets a <code>#!/bin/sh -e</code>
shebang invocation, which means that the script will halt execution at any point where it evaluates
a non-zero return code.  This means that the script needs to be written such a way that the
environment state testing being done always returns a true value so that the script does not fail,
hence the <code>||true</code> constructs.</p>
<p>We are attaching an extra IP address to the loopback interface, so we need to redirect traffic from
169.254.169.254:80 to the location where the fake metadata server is running.  We are dealing with
the loopback interface, which means that the PREROUTING nat table is never hit and we must use the
OUTPUT table instead.  You cannot DNAT packets destined for the loopback interface, because the
kernel will treat them as martians and drop them, so you must REDIRECT the packets to the desired
port.  When performing the redirection from port 80 to 8000 on the loopback interface, it sends the
packets to 127.0.0.1:8000, not 169.254.169.254:8000, so the fake metadata server must be listening
on localhost port 8000.</p>
<p>If for some reason, you need to troubleshoot the post install script, it can be found at
<code>/var/lib/dpkg/info/fake-metadata.postinst</code> following an attempted package installation.</p>
<div class="codehilite"><pre><span></span><span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> grep <span class="m">169</span>.254.169.254/32 /etc/network/interfaces <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> ! <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *169.254.169.254/32*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    sed -i <span class="s1">&#39;/iface lo inet loopback/a up ip addr add 169.254.169.254/32 dev lo scope host&#39;</span> /etc/network/interfaces
<span class="k">fi</span>

<span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> /sbin/ip addr <span class="p">|</span>grep <span class="m">169</span>.254.169.254/32 <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> ! <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *169.254.169.254/32*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    /sbin/ip addr add <span class="m">169</span>.254.169.254/32 dev lo scope host
<span class="k">fi</span>

<span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> grep iptables-restore /etc/network/interfaces <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> ! <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *iptables-restore*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    sed -i <span class="s1">&#39;/up ip addr add/a pre-up iptables-restore &lt; /etc/network/iptables.rules&#39;</span> /etc/network/interfaces
<span class="k">fi</span>

<span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> iptables -t nat -L <span class="p">|</span>grep <span class="m">8000</span> <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> ! <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *8000*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    iptables -t nat -A OUTPUT -p tcp -d <span class="m">169</span>.254.169.254/32 --dport <span class="m">80</span> -j REDIRECT --to-ports <span class="m">8000</span>
<span class="k">fi</span>

/usr/sbin/update-rc.d fake-metadata defaults
</pre></div>


<h1 id="postuninstall-script">PostUninstall Script<a class="headerlink" href="#postuninstall-script" title="Permanent link">&para;</a></h1>
<p>This script is the inverse of the post install script; it returns the system to its previous state.</p>
<div class="codehilite"><pre><span></span><span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> grep <span class="m">169</span>.254.169.254/32 /etc/network/interfaces <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *169.254.169.254/32*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    sed -i <span class="s1">&#39;/up ip addr add 169.254.169.254\/32 dev lo scope host/d&#39;</span> /etc/network/interfaces
<span class="k">fi</span>

<span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> /sbin/ip addr <span class="p">|</span>grep <span class="m">169</span>.254.169.254/32 <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *169.254.169.254/32*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    /sbin/ip addr delete <span class="m">169</span>.254.169.254/32 dev lo scope host
<span class="k">fi</span>

<span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> grep iptables-restore /etc/network/interfaces <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *iptables-restore*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    sed -i <span class="s1">&#39;/pre-up iptables-restore &lt; \/etc\/network\/iptables.rules/d&#39;</span> /etc/network/interfaces
<span class="k">fi</span>

<span class="nv">LINE</span><span class="o">=</span><span class="k">$(</span> iptables -t nat -L <span class="p">|</span>grep <span class="m">8000</span> <span class="o">||</span> <span class="nb">true</span> <span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$LINE</span><span class="s2">&quot;</span> <span class="o">==</span> *8000*  <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    iptables -t nat -D OUTPUT -p tcp -d <span class="m">169</span>.254.169.254/32 --dport <span class="m">80</span> -j REDIRECT --to-ports <span class="m">8000</span>
<span class="k">fi</span>

/usr/sbin/update-rc.d -f fake-metadata remove
rm -rf /apps/fake-metadata
pkill -f <span class="s1">&#39;supervise fake-metadata&#39;</span>
</pre></div>


<h1 id="log-rotation">Log Rotation<a class="headerlink" href="#log-rotation" title="Permanent link">&para;</a></h1>
<p>To keep the local Vagrant instance clean, it is useful to configure log rotation.  Sending a HUP
signal to the service allows it to continue writing to the new logfile.</p>
<div class="codehilite"><pre><span></span>/mnt/logs/fake-metadata/server.log <span class="o">{</span>
    daily
    rotate <span class="m">7</span>
    compress
    missingok
    notifempty
    create <span class="m">644</span> root root
    postrotate
        svc -h /service/fake-metadata
    endscript
<span class="o">}</span>
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../aws-credential-files-for-java-and-python/" title="AWS Credential Files for Java and Python" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                AWS Credential Files for Java and Python
              </span>
            </div>
          </a>
        
        
          <a href="../checking-and-changing-content-type-of-s3-object-with-awscli/" title="Checking and Changing Content-Type of S3 Object with AWSCLI" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Checking and Changing Content-Type of S3 Object with AWSCLI
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://buttons.github.io/buttons.js"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-52382416-1","copperlight.github.io"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>